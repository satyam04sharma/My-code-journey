#include<iostream>
using namespace std;
int main()
{
	int n,m,x,y,z;
	short T;
	cin>>T;
	while(T!=0)
	{
		cin>>n>>m;
		int count[m]={0};
		int a[n]={-1};
		for(int i=1;i<=m;i++)
		{
			cin>>x>>y>>z;
			if(x==y)
			{
				count[i]++;
				if(a[x]==-1)
				{
					a[x]=1;
					count[i]++;
					continue;
				}
				else if(a[x]==0)
				{
					count[i]++;
					continue;
				}
				else if(a[x]==1)
				{
					count[i]++;
					continue;
				}
			}
			else if(x<y)
			{
				count[i]++;
				if(a[x]&&a[y]==-1)
				{
					if(z==1)
					{
						a[x]=1;
						a[y]=0;
						count[i]++;
						continue;
					}
					if(z==0)
					{
						a[x]=a[y]=1;
						count[i]++;
						continue;
					}
				}
				if((a[x]==1&&a[y]==0)||(a[y]==1&&a[x]==0))
				{
					if(z==1)
					{
						count[i]++;
						continue;
					}
				}
				if(a[x]==a[y])
				{
					if(z==0)
					{
						count[i]++;
						continue;
					}
				}
				if(a[y]==1&&a[x]==-1)
				{
					if(z==1)
					{
						a[x]=0;
						count[i]++;
						continue;
					}
					else if(z==0)
					{
						a[x]=1;
						count[i]++;
						continue;
					}
				}
				if(a[y]==0&&a[x]==-1)
				{
					if(z==1)
					{
						a[x]=1;
						count[i]++;
						continue;
					}
					else if(z==0)
					{
						a[x]=0;
						count[i]++;
						continue;
					}
				}
				if(a[x]==1&&a[y]==-1)
				{
					if(z==1)
					{
						a[y]=0;
						count[i]++;
						continue;	
					}
					else if(z==0)
					{
						a[y]=1;
						count[i]++;
						continue;
					}
				}
				if(a[x]==0&&a[y]==-1)
				{
					if(z==1)
					{
						a[y]=1;
						count[i]++;
						continue;
					}
					else if(z==0)
					{
						a[y]=0;
						count[i]++;
						continue;
					}
				}
			}
			else if(x>y)
			{
				count[i]++;
				if(a[x]&&a[y]==-1)
				{
					if(z==1)
					{
						a[x]=0;
						a[y]=1;
						count[i]++;
						continue;
					}
					if(z==0)
					{
						a[x]=a[y]=1;
						count[i]++;
						continue;
					}
				}
				if((a[x]==0&&a[y]==1)||(a[y]==0&&a[x]==1))
				{
					if(z==1)
					{
						count[i]++;
						continue;
					}
				}
				if(a[x]==a[y])
				{
					if(z==0)
					{
						count[i]++;
						continue;
					}
				}
				if(a[y]==1&&a[x]==-1)
				{
					if(z==1)
					{
						a[x]=0;
						count[i]++;
						continue;
					}
					else if(z==0)
					{
						a[x]=1;
						count[i]++;
						continue;
					}
				}
				if(a[y]==0&&a[x]==-1)
				{
					if(z==1)
					{
						a[x]=1;
						count[i]++;
						continue;
					}
					else if(z==0)
					{
						a[x]=0;
						count[i]++;
						continue;
					}
				}
				if(a[x]==1&&a[y]==-1)
				{
					if(z==1)
					{
						a[y]=0;
						count[i]++;
						continue;
					}
					else if(z==0)
					{
						a[y]=1;
						count[i]++;
						continue;
					}
				}
				if(a[x]==0&&a[y]==-1)
				{
					if(z==1)
					{
						a[y]=1;
						count[i]++;
						continue;
					}
					else if(z==0)
					{
						a[y]=0;
						count[i]++;
						continue;
					}
				}
			}
		}
		if(count[m]=={2})
		{
			cout<<"yes";
		}
		else
		{
			cout<<"no";
		}
		T--;
		cout<<endl;
	}
}
